CREATE DATABASE Y_SIM_BOM;
CREATE SCHEMA Y_SIM_BOM.MASTER_DATA;
CREATE SCHEMA Y_SIM_BOM.BMATHUB_BASE;
CREATE SCHEMA Y_SIM_BOM.BMATHUB_XFRM;
CREATE SCHEMA Y_SIM_BOM.BMATHUB_ANALYSIS;
CREATE OR REPLACE STAGE Y_SIM_BOM.MASTER_DATA.SIM_BOM;
PUT file:///home/ubuntu/Documents/snowflake/item.csv @Y_SIM_BOM.MASTER_DATA.SIM_BOM;
PUT file:///home/ubuntu/Documents/snowflake/location.csv @Y_SIM_BOM.MASTER_DATA.SIM_BOM;
PUT file:///home/ubuntu/Documents/snowflake/orig_bom.csv @Y_SIM_BOM.MASTER_DATA.SIM_BOM;
call Y_SIM_BOM.BMATHUB_BASE.P_MASTER_ROOT_MAINTAIN();
call Y_SIM_BOM.BMATHUB_BASE.P_ROOT_CORE_BUILD();
truncate table Y_SIM_BOM.MASTER_DATA.ITEM;
truncate table Y_SIM_BOM.MASTER_DATA.LOCATION;
truncate table Y_SIM_BOM.MASTER_DATA.ORIG_BOM;
truncate table Y_SIM_BOM.BMATHUB_BASE.T_ITEM_DETAIL_ROOT;
truncate table Y_SIM_BOM.BMATHUB_BASE.T_COMPRESS_BOM_CORE;
truncate table Y_SIM_BOM.BMATHUB_BASE.T_LOCATION_ROOT;
truncate table Y_SIM_BOM.BMATHUB_BASE.T_METADATA_RULES;
truncate table Y_SIM_BOM.BMATHUB_BASE.T_ORIG_BOM;
SELECT * FROM Y_SIM_BOM.BMATHUB_ANALYSIS.V_SIM_BOM;
